---
layout: post
title: MySQL笔记
date: 2018-08-20
categories: blog
tags: [java]
description: 一句话描述。
---

[TOC]

## 复习
数据库要复习的地方：1）隔离级别；2）索引；3）范式[1NF：属性不可分；2NF：非主
键属性完全依赖于主键属性；3NF：非主键属性之间无传递依赖；4NF：主键属性之间无传递
依赖]；4）引擎。


##ER图
> 假设每个学生选修若干门课程，且每个学生每选一门课只有一个成绩，每个教师只担任一门课的教学,一门课由若干教师任教。“学生”有属性：学号、姓名、地址、年龄、性别。“教师”有属性：职工号、教师姓名、职称，“课程”有属性：课程号、课程名。

![ER教师学生图][1]

## 范式

- 第一范式
    - 当关系模式R的所有属性都不能在分解为更基本的数据单位时，称R是满足第一范式的，简记为1NF。满足第一范式是关系模式规范化的最低要求，否则，将有很多基本操作在这样的关系模式中实现不了
- 第二范式
    - 满足1NF后，要求表中的所有列，都必须依赖于主键，而不能有任何一列与主键没有关系，也就是说一个表只描述一件事情,称R满足第二范式，简记为2NF。
- 第三范式
    - 必须先满足第二范式（2NF），要求：表中的每一列只与主键直接相关而不是间接相关，（表中的每一列只能依赖于主键,简记为3NF.
- *如何更好的区分三大范式*
    -第 一范式在于有没有将属性完全细化,保证属性不会过于重复，第二范式是说一张表中包含了不同的实体属性，那么必须分成多张表，第三范式是要求已经分成了多张表，那么一张表中只能有另一张表中的id（主键），而不能有其他的任何信息（其他的信息一律用主键在另一表查询）。

## 完整性

- 1) 实体完整性：规定表的每一行在表中是惟一的实体。
- 2) 域完整性：是指表中的列必须满足某种特定的数据类型约束，其中约束又包括取值范围、精度等规定。
- 3) 参照完整性：是指两个表的主关键字和外关键字的数据应一致，保证了表之间的数据的一致性，防止了数据丢失或无意义的数据在数据库中扩散。
- 4) 用户定义的完整性：不同的关系数据库系统根据其应用环境的不同，往往还需要一些特殊的约束条件。用户定义的完整性即是针对某个特定关系数据库的约束条件，它反映某一具体应用必须满足的语义要求。


## 模式

**数据库系统采用三级模式结构：**

- 概念模式：也称模式，数据库中全体数据的逻辑结构和特征的描述，只涉及行的描述不涉及具体的值
- 外模式：也叫用户模式和子模式，是用户与数据库系统的接口，是用户用到的那部分数据的描述，由若干个外部记录数据类型组成
- 内模式：也称存储模式，是数据物理结构和存储方式的描述，是数据在数据库内部的表达方式，定义所有的内部记录类型、索引和文件的组织方式以及数据控制方面的细节
- 数据库在三级模式之间提供了两级映像：模式/内模式映像、外模式/模式映像
- 两级映像功能保证了数据的独立性


## 事务
- 原子性
    - 事物的所有操作在数据库中要么全部正确反映出来,要么完全不反应
- 一致性
    - 隔离执行事务时(换言之,在没有其他事务并发执行的情况下)保持数据库的一致性.
- 隔离性
    - 尽管多个事务可能并发执行,但系统保证,对于每一个事务都感觉不到系统中有其他事务在执行.
- 持久性
    - 一个事务完成后,他对数据库的改变必须是永久的,即使出现系统故障啧啧啧
      ​      
## 数据库引擎
- InnoDB
    - 支持事务,面向在线事务处理,拥有行锁设计,支持外键,支持非锁定读
- MyISAM
    - 不支持事务,有表锁和全文索引,在线分析处理速度快
- NDB
    - 集群式存储引擎,数据全部放在内存上,因此主键查找非常快,是高可用,高性能的集群系统
- Memory
    - 顾名思义,数据存在内存上,如果数据库重启或发生崩溃,数据将消失,默认使用哈希索引,而非B+树
    - 支持表锁,并发性能差

### 数据库连接池

chenShiZong


### InnoDB体系结构
- 后台线程
    - InnoDB存储引擎试下一个被称作master thread的线程上几乎实现了所有的功能
    - 后台线程有7个--4个IO thread,1个master thread,1个lock监控线程,1个错误监控线程
    - 4个IO线程分别是insert buffer thread,log thread,read thread,write thread.
- 内存
    - InnoDB存储引擎内存由缓冲池,重做日志缓冲池以及额外的内存池
    - 缓冲池中的数据页类型有:索引页,数据页,undo页,插入缓冲,自适应哈希索引,InnoDB存储的锁信息,数据字典
- 关键特性
    - 插入缓冲是


[1]: http://ocp77h2r6.bkt.clouddn.com/%E4%BA%8C%E5%9B%BE.png